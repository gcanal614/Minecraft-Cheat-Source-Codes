package me.dinozoid.strife.module.implementations.exploit;

import me.dinozoid.strife.alpine.listener.EventHandler;
import me.dinozoid.strife.alpine.listener.Listener;
import me.dinozoid.strife.event.implementations.network.PacketOutboundEvent;
import me.dinozoid.strife.module.Category;
import me.dinozoid.strife.module.Module;
import me.dinozoid.strife.module.ModuleInfo;
import me.dinozoid.strife.util.player.PlayerUtil;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.C03PacketPlayer;

import java.util.ArrayDeque;
import java.util.ArrayList;
import java.util.Deque;
import java.util.List;

@ModuleInfo(name = "Blink", renderName = "Blink", description = "Don't move on other people's screens.", category = Category.EXPLOIT)
public class BlinkModule extends Module {

    private Deque<Packet<?>> packets = new ArrayDeque<>();

    @Override
    public void onDisable() {
        super.onDisable();
        while(packets.size() > 0)
            mc.getNetHandler().getNetworkManager().sendPacket(packets.poll());
    }

    @EventHandler
    private final Listener<PacketOutboundEvent> packetOutboundListener = new Listener<>(event -> {
        if(event.packet() instanceof C03PacketPlayer) {
            packets.add(event.packet());
            event.cancel();
        }
    });

}
