package me.dinozoid.strife.module.implementations.exploit;

import me.dinozoid.strife.alpine.listener.EventHandler;
import me.dinozoid.strife.alpine.listener.Listener;
import me.dinozoid.strife.event.implementations.network.PacketInboundEvent;
import me.dinozoid.strife.event.implementations.network.PacketOutboundEvent;
import me.dinozoid.strife.event.implementations.player.UpdatePlayerEvent;
import me.dinozoid.strife.module.Category;
import me.dinozoid.strife.module.Module;
import me.dinozoid.strife.module.ModuleInfo;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.server.S08PacketPlayerPosLook;

@ModuleInfo(name = "NoRotate", renderName = "NoRotate", description = "Prevent the server from rotating you.", category = Category.EXPLOIT)
public class NoRotateModule extends Module {

    private float lastYaw, lastPitch;

    @EventHandler
    private final Listener<PacketOutboundEvent> packetOutboundListener = new Listener<>(event -> {
        if(event.packet() instanceof C03PacketPlayer.C04PacketPlayerPosition) {
            C03PacketPlayer.C04PacketPlayerPosition packet = (C03PacketPlayer.C04PacketPlayerPosition) event.packet();
            if(lastYaw != mc.thePlayer.rotationYaw && lastPitch != mc.thePlayer.rotationPitch) {
                lastYaw = packet.getYaw();
                lastPitch = packet.getPitch();
            }
        }
    });

    @EventHandler
    private final Listener<PacketInboundEvent> packetInboundListener = new Listener<>(event -> {
        if(event.packet() instanceof S08PacketPlayerPosLook) {
            mc.thePlayer.rotationYaw = lastYaw;
            mc.thePlayer.rotationPitch = lastPitch;
        }
    });

}
