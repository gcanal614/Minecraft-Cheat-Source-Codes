package today.sleek.client.modules.impl.exploit;

import com.google.common.eventbus.Subscribe;
import net.minecraft.item.ItemFood;
import net.minecraft.item.ItemPotion;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C08PacketPlayerBlockPlacement;
import today.sleek.base.event.impl.UpdateEvent;
import today.sleek.base.modules.ModuleCategory;
import today.sleek.base.modules.ModuleData;
import today.sleek.base.value.value.ModeValue;
import today.sleek.client.modules.impl.Module;
import today.sleek.client.utils.network.PacketUtil;

@ModuleData(
        name = "Fast Use",
        category = ModuleCategory.EXPLOIT,
        description = "Consumes items faster"
)
public class FastUse extends Module {

    private ModeValue modeValue = new ModeValue("Mode", this, "Verus", "Matrix", "Vanilla");

    @Subscribe
    public void onUpdate(UpdateEvent event) {
        if (mc.thePlayer.isUsingItem() && mc.thePlayer.isCollidedVertically && mc.thePlayer.getHeldItem().getItem() instanceof ItemFood || mc.thePlayer.isUsingItem() && mc.thePlayer.getHeldItem().getItem() instanceof ItemPotion) {

            switch (modeValue.getValueAsString()) {
                case "Verus": {
                    if (mc.thePlayer.isUsingItem()) {
                        if (mc.thePlayer.onGround) {
                            if (mc.thePlayer.ticksExisted % 4 == 0) {
                                for (int i = 0; i < 8; i++) {
                                    double x = mc.thePlayer.posX;
                                    double y = mc.thePlayer.posY + 1.0E-9;
                                    double z = mc.thePlayer.posZ;
                                    mc.thePlayer.sendQueue.addToSendQueue(new C03PacketPlayer.C06PacketPlayerPosLook(x, y, z, mc.thePlayer.rotationYaw, mc.thePlayer.rotationPitch, true));
                                }
                            }
                        }
                    }
                    break;
                }

                case "Vanilla": {
                    for (int i = 0; i < 20; i++) {
                        PacketUtil.sendPacketNoEvent(new C03PacketPlayer(mc.thePlayer.onGround));
                    }

                    break;
                }

                case "Matrix": {
                    for (int i = 0; i < 20; i++) {
                        PacketUtil.sendPacketNoEvent(new C08PacketPlayerBlockPlacement(mc.thePlayer.getPosition().down(256), 256, null, 0, 0, 0));
                        PacketUtil.sendPacket(new C03PacketPlayer.C04PacketPlayerPosition(mc.thePlayer.posX, mc.thePlayer.posY, mc.thePlayer.posZ, true));
                    }
                    break;
                }

            }
        }
    }

}
