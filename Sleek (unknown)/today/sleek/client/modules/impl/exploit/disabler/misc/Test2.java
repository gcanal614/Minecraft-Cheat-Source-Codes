package today.sleek.client.modules.impl.exploit.disabler.misc;

import today.sleek.base.event.impl.UpdateEvent;
import today.sleek.client.gui.notification.Notification;
import today.sleek.client.gui.notification.NotificationManager;
import today.sleek.client.modules.impl.exploit.disabler.DisablerMode;

import javax.vecmath.Vector3d;

public class Test2 extends DisablerMode {
    int morganNullVecTicks = 0;

    public Test2() {
        super("Test 2");
    }

    @Override
    public void onEnable() {
        getDisabler().setRepeatPos(null);
        morganNullVecTicks = 0;
    }

    @Override
    public void onUpdate(UpdateEvent event) {
        if (event.isPre()) {


                                    /*
        | - - - - HOW TO USE - - - - |

        on a movement module, cancel
        C03 packets while the mod
        is enabled.

        when it gets disabled;
        set 'Disabler.repeatPos'
        (Vector3d) to the players
        position
                                    */

            // Max ticks until giving up teleporting
            // (20 for almost 100% tp ratio)
            // (12 works fine, make it 15 if it's not working)
            int max = 15;
            if (getDisabler().getRepeatPos() == null) {
                morganNullVecTicks = 0;
            } else {
                if (morganNullVecTicks == 1) {
                    // Notif :D
                    NotificationManager.getNotificationManager().show(new Notification(Notification.NotificationType.INFO, "Disabler", "Validating Pos", 1000));
                }
                Vector3d vec = getDisabler().getRepeatPos();
                if (morganNullVecTicks >= max) {
                    // Nulls if X ticks elapsed
                    getDisabler().setRepeatPos(null);
                } else {
                    // Repeats your pos till Morgan
                    // eventually accepts it (best AC)
                    event.setOnGround(true);
                    mc.thePlayer.setPosition(vec.x, vec.y, vec.z);
                    mc.thePlayer.motionY = 0;
                    mc.thePlayer.motionX = 0;
                    mc.thePlayer.motionZ = 0;
                }
                morganNullVecTicks++;
            }
        }
    }
}
